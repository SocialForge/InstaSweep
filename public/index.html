<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <title>InstaSweep</title>
        <link rel="icon" type="image/x-icon" href="./assets/favicon/favicon-48.png" />
    </head>
    <style>
        :root {
            --brand-color: #6f849b;
        }

        * {
            box-sizing: border-box;
        }

        html {
            background: linear-gradient(45deg, #000, #333);
            background-attachment: fixed;
        }

        body {
            margin: 0;
            color: white;
            font-family: system-ui;
        }

        button {
            background: none;
            border: none;
            cursor: pointer;
        }

        summary {
            font-size: 1.5em;
            cursor: pointer;
        }

        textarea {
            background: white;
            margin: 0;
            font-size: 1.25em;
            resize: vertical;
            width: 100%;
            min-height: 20rem;
        }

        .hidden {
            display: none;
        }

        .toast {
            position: fixed;
            bottom: 1rem;
            left: 1rem;
            background: white;
            color: black;
            border-radius: 6px;
            font-size: 1.75em;
            padding: 2rem;
            z-index: 2;
        }

        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo-container > h1 {
            font-size: 5rem;
            letter-spacing: 2px;
            font-weight: lighter;
            margin-inline-start: 1.5rem;
        }

        .code-container {
            max-width: 50%;
            margin: 0 auto;
            margin-top: 50px;
        }

        .copy-button-container {
            display: flex;
            justify-content: center;
        }

        .copy-button {
            font-size: 2em;
            color: white;
            border: 1px solid white;
            height: 150px;
            width: 150px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0px rgba(255, 255, 255, 0.2);
            }
            100% {
                box-shadow: 0 0 0 20px rgba(255, 255, 255, 0);
            }
        }
    </style>

    <body>
        <div class="logo-container">
            <svg viewBox="13 15 73 69" width="55px" style="fill: #6f849b">
                <path
                    d="M71.79,15.18H28.21c-8.31,0-15.04,6.74-15.04,15.04v26.11c0,8.31,6.74,15.04,15.04,15.04h8.57l10.44,12.16   c0.73,0.85,1.75,1.28,2.78,1.28s2.05-0.43,2.78-1.28l10.44-12.16h8.57c8.31,0,15.04-6.74,15.04-15.04V30.23   C86.83,21.92,80.1,15.18,71.79,15.18z M82.83,56.34c0,6.09-4.95,11.04-11.04,11.04h-8.57h-1.84l-1.2,1.39L50,80.64L39.81,68.78   l-1.2-1.39h-1.84h-8.57c-6.09,0-11.04-4.95-11.04-11.04V30.23c0-6.09,4.95-11.04,11.04-11.04h43.57c6.09,0,11.04,4.95,11.04,11.04   V56.34z"
                />
                <path
                    d="M56.45,31.26c-0.11,0-0.22-0.01-0.33-0.01c-2.94,0-4.76,1.53-5.41,2.19L50,34.17l-0.71-0.73   c-0.64-0.66-2.46-2.19-5.41-2.19c-0.11,0-0.22,0-0.33,0.01c-2.52,0.1-4.9,1.28-6.52,3.24c-2.72,3.28-2.6,7.2,0.34,11.65   c0.04,0.06,4.03,5.79,12.64,10.53c8.58-4.73,12.6-10.48,12.63-10.52c2.95-4.46,3.06-8.38,0.34-11.66   C61.35,32.54,58.97,31.36,56.45,31.26z"
                />
            </svg>
            <h1>InstaSweep</h1>
        </div>
        <div class="copy-button-container">
            <button class="copy-button" onclick="copyToClipboard()">COPY</button>
        </div>
        <details class="code-container">
            <summary>Source code</summary>
            <textarea id="code"></textarea>
        </details>

        <div class="toast hidden"></div>
    </body>
    <script>
        const RAW_SCRIPT_URL = './dist.js';
        const TOAST_TIMEOUT_MS = 3000;

        async function getScript() {
            const script = await fetch(RAW_SCRIPT_URL);
            return await script.text();
        }

        let script;
        getScript().then(res => {
            script = res;
            document.getElementById('code').innerText = res;
        });

        function sleep(ms) {
            return new Promise(resolve => {
                setTimeout(resolve, ms);
            });
        }

        async function showToast(text, timeout) {
            const toastElement = document.querySelector('.toast');
            if (toastElement === null || !toastElement.classList.contains('hidden')) {
                return;
            }
            toastElement.classList.remove('hidden');
            toastElement.innerText = text;
            await sleep(timeout);
            toastElement.classList.add('hidden');
        }

        async function copyToClipboard() {
            await navigator.clipboard.writeText(script);
            showToast('Code copied!', TOAST_TIMEOUT_MS);
        }
    </script>
</html>
